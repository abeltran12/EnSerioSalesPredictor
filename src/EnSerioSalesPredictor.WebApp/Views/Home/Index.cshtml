@{
    ViewData["Title"] = "Home Page";
}

<script src="https://d3js.org/d3.v7.min.js"></script>

<div class="container mt-4">
    <div class="row justify-content-center align-items-center">
        <div class="col-auto">
            <label for="dataInput" class="form-label mb-0">Source Data:</label>
        </div>
        <div class="col-auto">
            <input id="dataInput" type="text" placeholder="10,20,30" class="form-control" style="width: 300px;">
        </div>
        <div class="col-auto">
            <button class="btn btn-primary" onclick="drawChart()">Update Data</button>
        </div>
    </div>

    <svg id="chart" width="600" height="400" style="margin-top:20px;"></svg>
</div>

<style>
    .bar-label {
        fill: white;
        font-size: 14px;
        font-weight: bold;
        text-anchor: end;
    }
</style>

<script>
function drawChart() {
    const input = document.getElementById('dataInput').value;
    if (!input) return; 

    const data = input.split(',').map(d => +d.trim()).filter(d => !isNaN(d));
    if (data.length === 0) return;

    const colors = ["#1f77b4", "#ff7f0e", "#2ca02c", "#d62728", "#9467bd", "#8c564b"];

    const svg = d3.select('#chart');
    svg.selectAll('*').remove();

    const width = +svg.attr('width');
    const barHeight = 30;
    const height = barHeight * data.length;
    svg.attr('height', height);

    const x = d3.scaleLinear()
        .domain([0, d3.max(data)])
        .range([0, width - 50]);

    const bars = svg.selectAll('g')
        .data(data)
        .enter()
        .append('g')
        .attr('transform', (d, i) => `translate(0, ${i * barHeight})`);

    bars.append('rect')
        .attr('height', barHeight - 5)
        .attr('width', d => x(d))
        .attr('fill', (d, i) => colors[i % colors.length]);
        
    bars.append('text')
        .attr('class', 'bar-label')
        .attr('x', d => x(d) - 5)
        .attr('y', barHeight / 2)
        .attr('dy', '.35em')
        .text(d => d);
}
</script>
